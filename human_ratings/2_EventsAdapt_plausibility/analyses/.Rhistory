rm(list=ls())
library(tidyverse)
library(stringr)
library(stringi)
# READ DATA
filenames=c('../results_raw/Batch_4332828_batch_results.csv',)
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
rm(list=ls())
library(tidyverse)
library(stringr)
library(stringi)
# READ DATA
filenames=c('../results_raw/Batch_4332828_batch_results.csv')
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
data = data %>% select(starts_with('Input'),starts_with('Answer'),starts_with('WorkerId'))
rm(list=ls())
library(tidyverse)
library(stringr)
library(stringi)
# READ DATA
filenames=c('../results_raw/Batch_4332828_batch_results.csv')
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
data = data %>% select(starts_with('Input'),starts_with('Answer'),starts_with('WorkerId'))
peek(data)
View(data)
head(data)
data = data %>% gather(key='variable',value="value",
-WorkerId,-Input.list,-Answer.country,
-Answer.English,-Answer.answer, -Answer.proficiency1,
-Answer.proficiency2)
filenames=c('../results_raw/Batch_4332828_batch_results.csv')
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
data = data %>% select(starts_with('Input'),starts_with('Answer'),starts_with('WorkerId'))
# gather (specify the list of columns you need)
data = data %>% gather(key='variable',value="value",
-WorkerId,-Input.list,-Answer.country,
-Answer.English,-Answer.answer, -Answer.proficiency1,
-Answer.proficiency2)
data = data %>% separate(variable, into=c('Type','TrialNum'),sep='__',convert=TRUE)
View(data)
data = data %>% spread(key = Type, value = value)
data = data %>%
filter(!(WorkerId %in% c('AT8S19U5993HR', 'A2R1A479K07ME5')))                   # bad responses
data$Answer.Rating <- as.numeric(data$Answer.Rating)
data = data %>%
separate(Input.code,into=c('TrialType','Plausibility','Item','xx1','xx2'),sep='_')
data = data %>% separate(Plausibility, into=c('Voice', 'Plausibility', 'xx3'), sep='-')
data$xx3 = NULL
data$xx1 = NULL
data$xx2 = NULL
write_csv(data,"longform_data.csv")
data = data %>%
group_by(WorkerId) %>%
mutate(
na.pct = mean(is.na(Answer.Rating)),
n = length(Answer.Rating))
data = data %>% ungroup()
help(summarize_at)
data %>% group_by(WorkerID, Plausibility) %>% summarise_at(c("Answer.Rating"), funs(mean(., na.rm=TRUE)))
data %>% group_by(WorkerId, Plausibility) %>% summarise_at(c("Answer.Rating"), funs(mean(., na.rm=TRUE)))
data %>%
group_by(WorkerId, Plausibility) %>%
summarise_at(c("Answer.Rating"), c(mean(., na.rm=TRUE)))
data %>%
group_by(WorkerId, Plausibility) %>%
summarise_at(c("Answer.Rating"), list(mean(., na.rm=TRUE)))
write_csv(data_summ,"data_summ_by_worker.csv")
z_score = function(xs) {
(xs - mean(xs)) / sd(xs)
}
data_summ = data %>%
group_by(WorkerId) %>%
summarize(
na.pct = mean(is.na(Answer.Rating)),
n = length(Answer.Rating))
write_csv(data_summ,"data_summ_by_worker.csv")
data$Item = as.numeric(data$Item)
data.good = data %>%
filter(Answer.English == "yes" &
Answer.country == "USA" &
TrialType != "filler" &
n <= num.trials) %>%
filter(!is.na(Answer.Rating))
View(data.good)
data.good.summary = data.good %>%
group_by(Plausibility, Item) %>%
summarize(
m = mean(Answer.Rating),
stdev= sd(Answer.Rating),
#    se = stdev/sqrt(n()),
#    upper= m+se*1.96,
#    lower=m-se*1.96
)
data.good.summary = data.good.summary[,c(2,1,3,4)]
write_csv(data.good.summary[order(data.good.summary$Item),],
"EventsRev_data_summ.csv")
View(data.good.summary)
View(data.good)
data.good.summary = data.good %>%
group_by(Plausibility, Voice, Item) %>%
summarize(
m = mean(Answer.Rating),
stdev= sd(Answer.Rating),
#    se = stdev/sqrt(n()),
#    upper= m+se*1.96,
#    lower=m-se*1.96
)
data.good.summary = data.good.summary[,c(2,1,3,4)]
data.good.summary = data.good %>%
group_by(Plausibility, Voice, Item) %>%
summarize(
m = mean(Answer.Rating),
stdev= sd(Answer.Rating),
#    se = stdev/sqrt(n()),
#    upper= m+se*1.96,
#    lower=m-se*1.96
)
data.good.summary = data.good %>%
group_by(Item, Plausibility, Voice) %>%
summarize(
m = mean(Answer.Rating),
stdev= sd(Answer.Rating),
#    se = stdev/sqrt(n()),
#    upper= m+se*1.96,
#    lower=m-se*1.96
)
write_csv(data.good.summary[order(data.good.summary$Item),],
"EventsRev_data_summ.csv")
data.good = data %>%
filter(Answer.English == "yes" &
Answer.country == "USA" &
TrialType != "filler" &
n <= num.trials) %>%
filter(!is.na(Answer.Rating))
data.good.summary = data.good %>%
group_by(Item, Plausibility, Voice) %>%
summarize(
m = mean(Answer.Rating),
stdev= sd(Answer.Rating),
#    se = stdev/sqrt(n()),
#    upper= m+se*1.96,
#    lower=m-se*1.96
)
View(data)
# READ DATA
filenames=c('../results_raw/Batch_4332828_batch_results.csv')
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
# only keep WorkerId and cols that Start with Answer or Input
data = data %>% select(starts_with('Input'),starts_with('Answer'),starts_with('WorkerId'))
# gather (specify the list of columns you need)
data = data %>% gather(key='variable',value="value",
-WorkerId,-Input.list,-Answer.country,
-Answer.English,-Answer.answer, -Answer.proficiency1,
-Answer.proficiency2)
# separate
data = data %>% separate(variable, into=c('Type','TrialNum'),sep='__',convert=TRUE)
# spread
data = data %>% spread(key = Type, value = value)
library(tidyverse)
library(stringr)
library(stringi)
# READ DATA
filenames=c('../results_raw/Batch_4332828_batch_results.csv')
data <- lapply(filenames, read.csv)
data = do.call("rbind", data)
num.trials = 54  # maximum number of trials per participant
# only keep WorkerId and cols that Start with Answer or Input
data = data %>% select(starts_with('Input'),starts_with('Answer'),starts_with('WorkerId'))
# gather (specify the list of columns you need)
data = data %>% gather(key='variable',value="value",
-WorkerId,-Input.list,-Answer.country,
-Answer.English,-Answer.answer, -Answer.proficiency1,
-Answer.proficiency2)
# separate
data = data %>% separate(variable, into=c('Type','TrialNum'),sep='__',convert=TRUE)
# spread
data = data %>% spread(key = Type, value = value)
## Summarize ratings data
data$Answer.Rating <- as.numeric(data$Answer.Rating)
data = data %>%
separate(Input.code,into=c('TrialType','cond','Item','xx1','xx2'),sep='_') %>%
separate(cond, into=c('Voice', 'Plausibility', 'xx3'), sep='-')
# info we don't need
data$xx3 = NULL
data$xx1 = NULL
data$xx2 = NULL
data_byplausibility = data %>%
group_by(WorkerId, Plausibility) %>%
summarise_at(c("Answer.Rating"), funs(mean(., na.rm=TRUE)))
View(data_byplausibility)
View(data_byplausibility)
